using GXPEngine;                                // GXPEngine contains the engine

static class Globals
{
    public static int health;
}

public class MyGame : Game
{
    private StartMenu _menu;
    private CreditsMenu _creditsmenu;
    private Level1 _level1;

    Sound _quitSound;

    public static float timeSince;

    public bool quitIsPressed;
    public bool level1IsActive;

    bool quitsoundHasPlayed;
    bool gameIsPaused;

    public MyGame() : base(1440, 1080, false, false)    // Create a window that's 1440x1080 and NOT fullscreen and V-Sync turned OFF
    {
        targetFps = 60;

        _quitSound = new Sound("QuitSound.mp3", false, true);

        quitIsPressed = false;
        quitsoundHasPlayed = false;
        level1IsActive = false;
        gameIsPaused = false;

        CreateMenu();
    }

    //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    //                                                                                                                        CreateMenu()
    //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    public void CreateMenu()
    {
        _menu = new StartMenu();
        AddChild(_menu);
    }

    //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    //                                                                                                                        CreateCreditsMenu()
    //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    public void CreateCreditsMenu()
    {
        _creditsmenu = new CreditsMenu();
        AddChild(_creditsmenu);
    }

    public void CreateGame()
    {
        _level1 = new Level1();
        AddChild(_level1);
    }

    //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    //                                                                                                                        HandleQuitButton()
    //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    public void HandleQuitButton()
    {
        if (quitIsPressed == true)
        {
            if (quitsoundHasPlayed == false)
            {
                _quitSound.Play();
                quitsoundHasPlayed = true;
            }

            if (Time.now >= timeSince + 950f)
            {
                Destroy();
                quitIsPressed = false;
            }
        }
    }

    //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    //                                                                                                                        HandlePause()
    //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    private void HandlePause()
    {
        if (Input.GetKeyDown(Key.P) && gameIsPaused == false)
        {
            if (level1IsActive == true)
            {
                _level1.Pause();
                gameIsPaused = true;
            }
        }
    }

    //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    //                                                                                                                        HandleUnpause()
    //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    private void HandleUnpause()
    {
        if (Input.GetKeyDown(Key.U) && gameIsPaused == true)
        {
            if (level1IsActive == true)
            {
                _level1.Unpause();
                gameIsPaused = false;
            }
        }
    }

    //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    //                                                                                                                        Update()
    //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    private void Update()
    {
        HandleQuitButton();

        HandlePause();
        HandleUnpause();
    }

    //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    //                                                                                                                        Main()
    //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    private static void Main()                  // Main() is the first method that's called when the program is run
    {
        new MyGame().Start();                   // Create a "MyGame" and start it
    }
}
