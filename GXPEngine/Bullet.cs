using System;
using GXPEngine;

namespace GXPEngine
{
    class Bullet : AnimationSprite
    {
        float bulletX;
        float bulletY;

        float GoToX;
        float GoToY;

        float speed;

        public Bullet(float bulletX, float bulletY, float GoToX, float GoToY) : base("bullet_tile.png", 1, 1)
        {
            Spawn();

            x = bulletX;
            y = bulletY;

            this.GoToX = GoToX;
            this.GoToY = GoToY;

            speed = 8f;
        }

        //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        //                                                                                                                        Spawn()
        //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        void Spawn()
        {
            SetOrigin(width / 2, height / 2);
            SetXY(bulletX, bulletY);
        }

        //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        //                                                                                                                        MoveBullets()
        //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        public void MoveBullets()
        {
            float deltaX = GoToX - x;
            float deltaY = GoToY - y;

            float distance = Mathf.Sqrt(deltaX * deltaX + deltaY * deltaY);

            if (distance > speed)
            {
                x += deltaX * speed / distance;
                y += deltaY * speed / distance;
            }
        }

        //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        //                                                                                                                        HandleRemove()
        //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        void HandleRemove()
        {
            if (x == GoToX && y == GoToY)
            {
                LateDestroy();
                LateRemove();
            }
        }

        //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        //                                                                                                                        Update()
        //----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        void Update()
        {
            MoveBullets();

            //HandleRemove();
        }
    }
}
